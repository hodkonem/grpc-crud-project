# gRPC CRUD –ü—Ä–æ–µ–∫—Ç

**–£—á–µ–±–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ —á–µ—Ä–µ–∑ gRPC –∏ –æ–±–º–µ–Ω —Å–æ–±—ã—Ç–∏—è–º–∏ —á–µ—Ä–µ–∑ Kafka.**

---

## üß© –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ –±–∞–∑–µ **Spring Boot**, **gRPC** –∏ **Apache Kafka**.  
–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —Ä–æ–ª—å, –æ–±—â–∞—è—Å—å —Å –¥—Ä—É–≥–∏–º–∏ —á–µ—Ä–µ–∑ gRPC-–≤—ã–∑–æ–≤—ã –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è.

–¶–µ–ª—å ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ **User ‚Üî Post ‚Üî Order ‚Üî Notification**,  
–≤–∫–ª—é—á–∞—è —Ä–∞–±–æ—Ç—É —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ (Saga) –∏ –∑–∞–ø—É—Å–∫ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã —á–µ—Ä–µ–∑ Docker Compose.

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
grpc-crud-project/
 ‚îú‚îÄ‚îÄ common-proto/              # –û–±—â–∏–µ .proto –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ gRPC –∫–ª–∞—Å—Å—ã
 ‚îú‚îÄ‚îÄ user-service/              # CRUD –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (PostgreSQL + gRPC)
 ‚îú‚îÄ‚îÄ post-service/              # CRUD –¥–ª—è –ø–æ—Å—Ç–æ–≤ + –ª–æ–≥–∏–∫–∞ "—Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏"
 ‚îú‚îÄ‚îÄ order-service/             # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä: –≤—ã–∑—ã–≤–∞–µ—Ç user/post —á–µ—Ä–µ–∑ gRPC –∏ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ Kafka
 ‚îú‚îÄ‚îÄ notification-service/      # –ö–æ–Ω—Å—å—é–º–µ—Ä Kafka, –ª–æ–≥–∏—Ä—É—é—â–∏–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
 ‚îú‚îÄ‚îÄ docker/                    # Docker Compose, .env, –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
 ‚îî‚îÄ‚îÄ README.md
```

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|------------|-------------|
| –Ø–∑—ã–∫ | Java 21 |
| –§—Ä–µ–π–º–≤–æ—Ä–∫ | Spring Boot 3.5.x |
| –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ | gRPC, Protobuf |
| –°–æ–æ–±—â–µ–Ω–∏—è | Apache Kafka |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | PostgreSQL + Flyway |
| –°–±–æ—Ä–∫–∞ | Gradle (Groovy DSL) |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è | Docker Compose |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | JUnit 5, Testcontainers |
| –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | Spring Boot Actuator |

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω **JDK 21+**
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã **Docker** –∏ **Docker Compose**
- **Gradle 8+**
- (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) **IntelliJ IDEA** —Å –ø–ª–∞–≥–∏–Ω–æ–º gRPC

### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä–∫–∞
```bash
git clone https://github.com/<—Ç–≤–æ–π-–ª–æ–≥–∏–Ω>/grpc-crud-project.git
cd grpc-crud-project
./gradlew clean build
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
docker compose up --build
```

---

## üß± –ú–æ–¥—É–ª–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å

| –≠—Ç–∞–ø | –ú–æ–¥—É–ª—å | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|:------|:--------|:--------:|:-------------|
| ‚úÖ | **common-proto** | üü¢ –≥–æ—Ç–æ–≤ | .proto –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –¥–ª—è User –∏ Post |
| üöß | **user-service** | üü° –≤ —Ä–∞–±–æ—Ç–µ | CRUD + gRPC —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| ‚è≥ | **post-service** | ‚ö™ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ | CRUD + —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ |
| ‚è≥ | **order-service** | ‚ö™ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ | –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è User/Post + —Å–æ–±—ã—Ç–∏—è –≤ Kafka |
| ‚è≥ | **notification-service** | ‚ö™ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ | Kafka consumer –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π |

---

## ‚öôÔ∏è –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ:

### –ü—Ä–∏–º–µ—Ä: `user-service`
```bash
cd user-service
./gradlew bootRun
```
- gRPC –ø–æ—Ä—Ç: **9090**
- REST –ø–æ—Ä—Ç (–µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω): **8081**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ grpcurl:
  ```bash
  grpcurl -plaintext localhost:9090 ru.itwizardry.grpc.user.UserService/GetUser -d '{"id": 1}'
  ```

### –ü—Ä–∏–º–µ—Ä: `post-service`
```bash
cd post-service
./gradlew bootRun
```
- gRPC –ø–æ—Ä—Ç: **9091**
- REST –ø–æ—Ä—Ç: **8082**

### –ü—Ä–∏–º–µ—Ä: `order-service`
```bash
cd order-service
./gradlew bootRun
```
- gRPC –ø–æ—Ä—Ç: **9092**
- REST –ø–æ—Ä—Ç: **8083**
- –ü—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ Kafka (—Ç–æ–ø–∏–∫ `orders`)

### –ü—Ä–∏–º–µ—Ä: `notification-service`
```bash
cd notification-service
./gradlew bootRun
```
- –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ Kafka-—Ç–æ–ø–∏–∫ `orders`
- –õ–æ–≥–∏—Ä—É–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª—å

---

## üåç –ü–æ—Ä—Ç—ã –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –°–µ—Ä–≤–∏—Å | REST | gRPC | PostgreSQL | Kafka | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|---------|------|------|-------------|--------|-------------|
| user-service | 8081 | 9090 | 5433 | ‚Äì | CRUD –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| post-service | 8082 | 9091 | 5434 | ‚Äì | CRUD –ø–æ—Å—Ç–æ–≤ + —Ä–µ–∑–µ—Ä–≤ |
| order-service | 8083 | 9092 | 5435 | 9094 | –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è + Kafka producer |
| notification-service | 8084 | ‚Äì | ‚Äì | 9094 | Kafka consumer |

**–ü—Ä–∏–º–µ—Ä `.env`:**
```env
POSTGRES_USER=admin
POSTGRES_PASSWORD=admin
POSTGRES_DB=appdb
KAFKA_BROKER=kafka:9094
```

---

## üìã –ü–ª–∞–Ω —Ä–∞–±–æ—Ç

- [x] –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- [x] –ú–æ–¥—É–ª—å `common-proto` –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è gRPC —Å—Ç–∞–±–∞
- [ ] CRUD + gRPC –¥–ª—è `UserService`
- [ ] CRUD + —Ä–µ–∑–µ—Ä–≤ –¥–ª—è `PostService`
- [ ] –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ–±—ã—Ç–∏—è –≤ `OrderService`
- [ ] –ö–æ–Ω—Å—å—é–º–µ—Ä `NotificationService`
- [ ] Docker Compose –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (Testcontainers + gRPC)
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (Prometheus + Grafana)

---

## üë• –ö–æ–º–∞–Ω–¥–∞

| –†–æ–ª—å | –£—á–∞—Å—Ç–Ω–∏–∫ |
|------|-----------|
| –¢–∏–º–ª–∏–¥ | @mikhail-teamlead |
| –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ | @evgeniy-dev, @ivan-dev, @dmitry-dev, @artem-dev |

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Spring Boot](https://spring.io/projects/spring-boot)
- [gRPC-Java](https://grpc.io/docs/languages/java/)
- [Spring for Apache Kafka](https://spring.io/projects/spring-kafka)
- [Testcontainers](https://testcontainers.com/)
- [–®–∞–±–ª–æ–Ω Saga (microservices.io)](https://microservices.io/patterns/data/saga.html)

---

## üß† –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö ‚Äî –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π –ø–æ **–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ**, **gRPC** –∏ **Kafka**.  
–í –¥–∞–ª—å–Ω–µ–π—à–µ–º –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é —Å–∞–≥–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–µ—Ç—Ä–∏–∫–∏ –∏ CI/CD.
